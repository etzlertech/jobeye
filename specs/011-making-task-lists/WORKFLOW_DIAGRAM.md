# Task Template Management - Complete Workflow

## ğŸ­ User Roles & Capabilities

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SUPERVISOR                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Create/edit/delete task templates                             â”‚
â”‚ â€¢ Apply templates to jobs (creation or existing)                â”‚
â”‚ â€¢ Add/edit/delete individual tasks on jobs                      â”‚
â”‚ â€¢ View task completion progress (read-only)                     â”‚
â”‚ â€¢ Cannot complete tasks (crew's responsibility)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            CREW                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ View task list for assigned jobs                              â”‚
â”‚ â€¢ Complete tasks (with photo verification if required)          â”‚
â”‚ â€¢ Cannot edit/delete tasks                                      â”‚
â”‚ â€¢ Cannot create templates                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Complete User Journey

### Journey 1: Supervisor Creates Template & Job

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Create Template                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Supervisor navigates to /supervisor/templates                   â”‚
â”‚           â†“                                                      â”‚
â”‚ Clicks "Create Template"                                        â”‚
â”‚           â†“                                                      â”‚
â”‚ Fills form:                                                     â”‚
â”‚   â€¢ Name: "Standard Lawn Service"                              â”‚
â”‚   â€¢ Description: "Standard residential lawn care"              â”‚
â”‚   â€¢ Job Type: "lawn_maintenance"                               â”‚
â”‚   â€¢ Active: âœ“                                                  â”‚
â”‚           â†“                                                      â”‚
â”‚ Adds task items:                                                â”‚
â”‚   1. "Mow grass" (required, photo verification)                â”‚
â”‚   2. "Edge borders" (required, photo verification)             â”‚
â”‚   3. "Blow off clippings" (optional)                           â”‚
â”‚   4. "Take completion photo" (required, photo)                 â”‚
â”‚           â†“                                                      â”‚
â”‚ Saves template â†’ API creates in database                        â”‚
â”‚           â†“                                                      â”‚
â”‚ Redirected to /supervisor/templates (shows new template)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: Create Job with Template                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Supervisor navigates to /supervisor/jobs                        â”‚
â”‚           â†“                                                      â”‚
â”‚ Clicks "Create Job"                                             â”‚
â”‚           â†“                                                      â”‚
â”‚ Fills job form:                                                 â”‚
â”‚   â€¢ Customer: "John Smith"                                      â”‚
â”‚   â€¢ Property: "123 Main St"                                     â”‚
â”‚   â€¢ Title: "Weekly lawn service"                                â”‚
â”‚   â€¢ Date: 2025-10-20                                            â”‚
â”‚   â€¢ Template: "Standard Lawn Service" â† SELECTS TEMPLATE        â”‚
â”‚           â†“                                                      â”‚
â”‚ Preview shows: "4 tasks will be added"                          â”‚
â”‚           â†“                                                      â”‚
â”‚ Clicks "Create Job" â†’ API creates job + instantiates template   â”‚
â”‚           â†“                                                      â”‚
â”‚ 4 tasks automatically created:                                  â”‚
â”‚   â€¢ workflow_tasks records with job_id, template_id             â”‚
â”‚   â€¢ status: pending                                             â”‚
â”‚   â€¢ task_order: 0, 1, 2, 3                                      â”‚
â”‚           â†“                                                      â”‚
â”‚ Redirected to /supervisor/jobs/[jobId]                          â”‚
â”‚ Shows job details + 4 tasks in task list                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Journey 2: Supervisor Adds Tasks to Existing Job

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SCENARIO: Job created WITHOUT template, need to add tasks       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Supervisor viewing /supervisor/jobs/[jobId]                     â”‚
â”‚           â†“                                                      â”‚
â”‚ Sees "No tasks yet" or empty task list                          â”‚
â”‚           â†“                                                      â”‚
â”‚ OPTION A: Click "Add Tasks from Template"                       â”‚
â”‚           â†“                                                      â”‚
â”‚ Dropdown shows available templates                              â”‚
â”‚           â†“                                                      â”‚
â”‚ Selects "Standard Lawn Service"                                 â”‚
â”‚           â†“                                                      â”‚
â”‚ POST /api/task-templates/[id]/instantiate                       â”‚
â”‚           â†“                                                      â”‚
â”‚ 4 tasks created and added to job                                â”‚
â”‚           â†“                                                      â”‚
â”‚ Task list refreshes, shows 4 tasks                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OPTION B: Click "Add Task" (individual task)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Modal opens with TaskEditor form                                â”‚
â”‚           â†“                                                      â”‚
â”‚ Fills form:                                                     â”‚
â”‚   â€¢ Description: "Check sprinkler system"                       â”‚
â”‚   â€¢ Order: 5                                                    â”‚
â”‚   â€¢ Required: âœ“                                                â”‚
â”‚   â€¢ Photo verification: âœ“                                       â”‚
â”‚   â€¢ Supervisor approval: -                                      â”‚
â”‚   â€¢ Criteria: "All zones functioning"                           â”‚
â”‚           â†“                                                      â”‚
â”‚ Clicks "Add Task" â†’ POST /api/jobs/[jobId]/tasks               â”‚
â”‚           â†“                                                      â”‚
â”‚ Task created in database                                        â”‚
â”‚           â†“                                                      â”‚
â”‚ Task list updates (optimistic UI)                               â”‚
â”‚           â†“                                                      â”‚
â”‚ New task appears in list at position 5                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Journey 3: Crew Completes Tasks

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Crew member assigned to job                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Navigates to /crew/jobs/[jobId]                                â”‚
â”‚           â†“                                                      â”‚
â”‚ Sees job details + Task List component (editable)               â”‚
â”‚           â†“                                                      â”‚
â”‚ Task List shows:                                                â”‚
â”‚   âœ“ 1. Mow grass (complete) â† already done                     â”‚
â”‚   â³ 2. Edge borders (in progress)                              â”‚
â”‚   â—‹ 3. Blow off clippings (pending)                            â”‚
â”‚   â—‹ 4. Take completion photo (pending)                         â”‚
â”‚           â†“                                                      â”‚
â”‚ Clicks task #2 "Edge borders"                                   â”‚
â”‚           â†“                                                      â”‚
â”‚ Photo verification required â†’ camera opens                      â”‚
â”‚           â†“                                                      â”‚
â”‚ Takes photo of edged borders                                    â”‚
â”‚           â†“                                                      â”‚
â”‚ Photo uploaded to storage                                       â”‚
â”‚           â†“                                                      â”‚
â”‚ PATCH /api/jobs/[jobId]/tasks/[taskId]                         â”‚
â”‚   â€¢ status: complete                                            â”‚
â”‚   â€¢ completed_at: timestamp                                     â”‚
â”‚   â€¢ verification_photo_url: <url>                               â”‚
â”‚   â€¢ completed_by: crew_user_id                                  â”‚
â”‚           â†“                                                      â”‚
â”‚ Task updates to "complete" status                               â”‚
â”‚           â†“                                                      â”‚
â”‚ Progress updates: "2 of 4 complete (50%)"                       â”‚
â”‚           â†“                                                      â”‚
â”‚ Continues with remaining tasks...                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Journey 4: Supervisor Monitors Progress

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ While crew is working...                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Supervisor views /supervisor/jobs/[jobId]                       â”‚
â”‚           â†“                                                      â”‚
â”‚ Sees Task List (read-only view):                                â”‚
â”‚   âœ“ 1. Mow grass                                               â”‚
â”‚      Completed by Mike â€¢ 1 hour ago                            â”‚
â”‚      Photo verified (98% confidence)                            â”‚
â”‚                                                                 â”‚
â”‚   âœ“ 2. Edge borders                                            â”‚
â”‚      Completed by Mike â€¢ 30 mins ago                           â”‚
â”‚      Photo verified (95% confidence)                            â”‚
â”‚                                                                 â”‚
â”‚   â³ 3. Blow off clippings (in progress)                        â”‚
â”‚                                                                 â”‚
â”‚   â—‹ 4. Take completion photo (pending)                         â”‚
â”‚                                                                 â”‚
â”‚ Progress: 2 of 4 complete (50%)                                â”‚
â”‚           â†“                                                      â”‚
â”‚ Can click task to view photos/details                           â”‚
â”‚           â†“                                                      â”‚
â”‚ Can edit task if needed (opens TaskEditor)                      â”‚
â”‚           â†“                                                      â”‚
â”‚ Can delete task if needed (soft delete)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ºï¸ Page Navigation Map

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SUPERVISOR NAVIGATION                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/supervisor/templates â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                         â”‚
  â”œâ”€ [+ Create] â”€â”€â†’ /supervisor/templates/create
  â”‚                      â”‚
  â”‚                      â””â”€ [Save] â”€â”€â†’ back to /supervisor/templates
  â”‚
  â””â”€ [Edit] â”€â”€â†’ /supervisor/templates/[id]/edit
                      â”‚
                      â””â”€ [Save] â”€â”€â†’ back to /supervisor/templates


/supervisor/jobs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                         â”‚
  â”œâ”€ [+ Create Job] â”€â”€â†’ job creation form  â”‚
  â”‚      â”‚                                  â”‚
  â”‚      â”œâ”€ Select Template (optional)     â”‚
  â”‚      â””â”€ [Create] â”€â”€â†’ /supervisor/jobs/[jobId]
  â”‚
  â””â”€ Click job â”€â”€â†’ /supervisor/jobs/[jobId]
                      â”‚
                      â”œâ”€ View task list (read-only)
                      â”œâ”€ [Add from Template] â”€â”€â†’ instantiate
                      â”œâ”€ [+ Add Task] â”€â”€â†’ TaskEditor modal
                      â”œâ”€ [Edit Task] â”€â”€â†’ TaskEditor modal
                      â””â”€ [Delete Task] â”€â”€â†’ soft delete


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       CREW NAVIGATION                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/crew â”€â”€â†’ /crew/jobs/[jobId]
             â”‚
             â”œâ”€ View task list (editable)
             â”œâ”€ Click task â”€â”€â†’ complete task
             â”‚    â”‚
             â”‚    â”œâ”€ If photo required â”€â”€â†’ camera
             â”‚    â””â”€ Mark complete
             â”‚
             â””â”€ Voice commands:
                  "Show tasks"
                  "Complete task 2"
                  "Next task"
```

---

## ğŸ’¾ Data Model Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   task_templates     â”‚  â† Supervisor creates
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                   â”‚
â”‚ tenant_id            â”‚
â”‚ name                 â”‚
â”‚ description          â”‚
â”‚ job_type             â”‚
â”‚ is_active            â”‚
â”‚ created_by           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ has many
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ task_template_items  â”‚  â† Template items
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                   â”‚
â”‚ template_id          â”‚  FK â†’ task_templates.id
â”‚ task_order           â”‚
â”‚ task_description     â”‚
â”‚ is_required          â”‚
â”‚ requires_photo_...   â”‚
â”‚ requires_super...    â”‚
â”‚ acceptance_criteria  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ instantiate
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   workflow_tasks     â”‚  â† Actual job tasks
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                   â”‚
â”‚ job_id               â”‚  FK â†’ jobs.id
â”‚ template_id          â”‚  FK â†’ task_templates.id (nullable)
â”‚ task_description     â”‚
â”‚ task_order           â”‚
â”‚ status               â”‚  pending â†’ in_progress â†’ complete
â”‚ is_required          â”‚
â”‚ is_deleted           â”‚  soft delete flag
â”‚ completed_by         â”‚  FK â†’ users.id
â”‚ completed_at         â”‚
â”‚ verification_photo   â”‚
â”‚ ai_confidence        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Key Decision Points

### When creating a job:
```
START â†’ Select template?
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â”‚          â”‚
   YES        NO
    â”‚          â”‚
    â†“          â†“
Template   No tasks
tasks      created
created    initially
    â”‚          â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â†“
   Job created
```

### When viewing job as supervisor:
```
Has tasks? â”€â”€â”€â”
              â”‚
         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
         â”‚          â”‚
        YES        NO
         â”‚          â”‚
         â†“          â†“
   Show task   "Add Tasks"
   list with   button only
   progress
         â”‚
         â”œâ”€ Add from template
         â”œâ”€ Add individual task
         â”œâ”€ Edit task
         â””â”€ Delete task
```

### When completing task as crew:
```
Task requires photo?
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â”‚          â”‚
   YES        NO
    â”‚          â”‚
    â†“          â†“
 Open       Mark
 camera   complete
    â”‚          â”‚
    â”œâ”€â”€ Take photo
    â”œâ”€â”€ Upload
    â””â”€â”€ Mark complete
```

---

## ğŸ“Š State Management

### TaskList Component States
```typescript
interface TaskListState {
  tasks: WorkflowTask[];
  loading: boolean;
  error: string | null;
  isOffline: boolean;
}

// Supervisor mode: editable=false, showActions=true
// Crew mode: editable=true, showActions=false
```

### Template Form States
```typescript
interface TemplateFormState {
  name: string;
  description: string;
  job_type: string | null;
  is_active: boolean;
  items: TemplateItemInput[];
}

interface TemplateItemInput {
  task_order: number;
  task_description: string;
  is_required: boolean;
  requires_photo_verification: boolean;
  requires_supervisor_approval: boolean;
  acceptance_criteria: string | null;
}
```

---

## âœ… Success Criteria Checklist

- [ ] Supervisor can create template with 5+ items in < 3 minutes
- [ ] Template appears in list immediately after creation
- [ ] Job creation form shows template selector
- [ ] Selecting template shows task count preview
- [ ] Job created with template has all tasks
- [ ] Supervisor can view tasks on job detail page
- [ ] Supervisor can add template to existing job
- [ ] Supervisor can add individual task to job
- [ ] Supervisor can edit task description/requirements
- [ ] Supervisor can delete task (soft delete)
- [ ] Crew can view and complete tasks
- [ ] Task progress updates in real-time
- [ ] Photo verification works correctly
- [ ] All operations respect tenant isolation
- [ ] Mobile UI works on 375px viewport
- [ ] No TypeScript errors
- [ ] All tests passing

---

**Ready to implement? Let's start with Phase 1!**
